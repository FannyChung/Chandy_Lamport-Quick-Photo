#include <iostream>
#include <stdlib.h>
#include <sys/shm.h>
#include <sys/ipc.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sstream>
#include <time.h>
#include <unistd.h>
#include <math.h>
#include <algorithm>
using namespace std;


int main()
{
    int shm_id;
    key_t shm_key;
    char *buf;
    char result[10];
    shm_key = ftok("/tmp/shm_demo", 101); /* p2_1 */
    shm_id = shmget(shm_key, 0, 0);
    buf = (char *) shmat(shm_id, NULL, 0);
    int n=0;
    while (1)
    {
        while (*buf==NULL||(buf[0] == '0' && buf[1] == '0'))
            ;
        memcpy(result, buf, 10);
        buf[0] = '0';
        buf[1] = '0';
        n++;
        fprintf(stdout, "result%d: %s\n",n, result);
    }
}
